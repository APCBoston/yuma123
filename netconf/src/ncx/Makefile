# Makefile for NETCONF project
#  
#   ncx directory

############### SOURCE PROFILE ##############################

SUBDIR_NM=ncx
SUBDIR_CPP=

############### TARGET PROFILE ##############################

TARGET=$(TBASE)/$(SUBDIR_NM)
LIB_INST=$(TBASE)/lib

ifdef MAXWELL
REAL_INST=/lib
else
REAL_INST=/usr/lib
endif

######################### MAKE RULES ######################

all: ncxdummy ncxlib

#################### PLATFORM DEFINITIONS ############
include ../platform/platform.profile

################ DEPENDENCIES #########################
# depend rule must be included after the 'all' make rule

include ../platform/platform.profile.depend


test:


install:
	sudo install --owner=root $(GRP) \
	$(LIB_INST)/lib$(SUBDIR_NM).so \
	$(REAL_INST)
	sudo ldconfig

ifdef STATIC
ncxlib: $(LBASE)/lib$(SUBDIR_NM).a
else
ncxlib: $(LBASE)/lib$(SUBDIR_NM).so
endif

# this dummy rule keeps make from deleting the $(OBJS) as
# intermediate files
ncxdummy: dependencies $(OBJS)

clean:
	rm -f $(OBJS) $(LBASE)/lib$(SUBDIR_NM).*

superclean:
	rm -f *~  $(DEPS) dependencies $(OBJS) \
	$(LBASE)/lib$(SUBDIR_NM).*


$(LBASE)/libncx.so: $(OBJS)
	gcc -shared -Wl,-soname,libncx.so -o $@ $(OBJS) -lc


#	sudo ldconfig -n $(LBASE)

# prevent the make program from choking on all the symbols
# that get generated from autogenerated make rules
.NOEXPORT:

include dependencies


