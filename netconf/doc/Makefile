# Makefile for Yuma doc directory
#  
#   doc directory

ifndef PREFIX
    PREFIX=/usr
endif

DOC_INSTALL = $(DESTDIR)$(PREFIX)/share/doc/yuma

ODTS = $(wildcard yuma_docs/*.odt)

PDFS = $(patsubst yuma_docs/%.odt,yuma_docs/pdf/%.pdf,$(ODTS))

CONVERT = unoconv

all: 

pdfs: $(PDFS)

# this does not work reliably called from debuild
# so building PDF from ODT is not part of the build process
yuma_docs/pdf/%.pdf: yuma_docs/%.odt
	$(CONVERT) $<
	mv $(patsubst yuma_docs/%.odt,yuma_docs/%.pdf,$<) $@

depend:

clean:

superclean:

uninstall:
	rm -f $(DOC_INSTALL)

ifdef DEBIAN
ifdef DOC
install: manuals
else
ifdef DEVELOPER
install:
else
install: cmninstall
endif  # DEVELOPER
endif  # DOC
else
# install everything
install: cmninstall manuals
endif  # DEBIAN


cmninstall:
	mkdir -p $(DOC_INSTALL)
	cp extra/AUTHORS $(DOC_INSTALL)
	cp extra/README $(DOC_INSTALL)
	cp extra/COPYRIGHT $(DOC_INSTALL)
	cp extra/yuma-legal-notices.pdf $(DOC_INSTALL)


manuals:
	mkdir -p $(DOC_INSTALL)
	cp yuma_docs/server-call-chain.txt $(DOC_INSTALL)
	(cd yuma_docs;tar cf t.tar --exclude=copy.sh --exclude=.svn pdf html;mv t.tar $(DOC_INSTALL))
	(cd $(DOC_INSTALL);tar xf t.tar;rm t.tar)



distclean: superclean uninstall


.PHONY: all clean depend superclean install distclean uninstall pdfs \
	cmninstall manuals

# prevent the make program from choking on all the symbols
# that get generated from autogenerated make rules
.NOEXPORT:



