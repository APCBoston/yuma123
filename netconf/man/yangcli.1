.\" Process this file with
.\" nroff -e -mandoc foo.1
.\"
.TH yangcli 1 "January 14, 2010" Linux "yangcli 0.9.9"
.SH NAME
yangcli \- YANG-based NETCONF-over-SSH client application

.SH SYNOPSIS
.nf

   yangcli [parameter=value...]

   yangcli --help [brief | normal | full]

   yangcli --version


.fi
.SH DESCRIPTION
.B yangcli
is a Command Line Interface for the NETCONF protocol.
.nf

    Normal Mode:
       An interactive CLI shell with command line history.
    
    Autostart-mode:
       If the 'server' parameter is present, then yangcli will
        attempt to connect to that server upon startup.  If the
       'user' and 'password' parameters are also present, then
       the user will not be prompted before the connection
       is attempted.  This parameter will be processed first,
       if script-mode or batch-mode is used.
    
    Script-mode:
       If the 'run-script' or 'run-command' parameter is present,
       then the specified script or command will be run automatically
       upon startup.

    Batch-mode:
       If the 'batch-mode' parameter is present, then either the
       'run-script' or 'run-command' parameter will be invoked, if
       present, and then the program will exit.
.fi
.SH USAGE
Parameters can be entered in any order, and have the form:

   \fB[start] name [separator [value]]\fP

where:

    \fBstart\fP == 0, 1, or 2 dashes (foo, -foo, --foo)

    \fBname\fP == parameter name
.nf

         Parameter name completion will be attempted 
         if a partial name is entered.

.fi
    \fBseparator\fP == whitespace or equals sign (foo=bar, foo bar)

    \fBvalue\fP == string value for the parameter.
.nf

         Strings with whitespace need to be double quoted 
         (--foo="some string")

.fi
Some examples of valid command line parameters:
.nf

   foo=3
   -foo=3
   --foo=3
   foo 3
   foo=fred
   --foo "fred flintstone"
.fi

Partial parameter names can be entered if they are unique.

.SH OPTIONS
.IP --\fBautocomp\fP=boolean
Controls whether partial keywords will be 
checked for interactive or script commands.
If true (the default), the first match for a partial keyword
will be used if no definition is found for
a command name or parameter name.
If false, then exact command and parameter name values
must be given.
.IP --\fBautohistory\fP=boolean
Controls whether the command line history buffer will
be saved at exit and loaded at startup.
If true, the default history file will be used
(~/.yuma/.yangcli_history) for loading
and saving the history buffer.  This is the default value.
If false, the history buffer will only be stored
and loaded manually with the history command.
.IP --\fBautoload\fP=boolean
Controls whether any YANG content modules
will be automatically loaded upon startup or
upon session startup with a server. This is the
default value.  If false, the 'load-module' command
must be used to explicitly load all the desired 
definition modules.
.IP --\fBbad-data\fP=enum
Specifies how invalid user input from the CLI
will be handled when filling PDUs for remote
operations.
.nf

   enum values:
      ignore(0)
         Silently accept invalid PDU and data model 
         parameters.  Intended for advanced server
         testing mode only.
      warn(1)
         Warn, but accept invalid PDU and data model 
         parameters.
      check(2)
         Prompt the user to keep the invalid value
         or re-enter the value.
      error(3)
         Prompt the user to re-enter the invalid value.
.fi  
.IP --\fBbatch-mode\fP
If present, the interactive CLI will not be used.
A script should be provided with the 'run-script'
parameter, or a command provided with the 'run-command'
parameter, or else the program will simply exit.
If the auto-connect mode is enabled, then this will mode
simply test if a NETCONF session can be established,
then exit.
.IP --\fBconfig\fP=filespec
The name of the configuration file to use.
Any parameter except this one can be set in the config file.
The default config file 
.I /etc/yuma/yangcli.conf
will be not be checked if this parameter is present.
.IP --\fBdatapath\fP=list
Internal file search path for configuration data files.
Overrides the YUMA_DATAPATH environment variable.
.IP --\fBdefault-module\fP=string
Default module name string to use before 'netconf' 
and 'yangcli' are tried.  The module prefix may need to be
used for other modules.
.IP --\fBdeviation\fP=string
 This parameter identifies a YANG module that
should only be checked for deviation statements
for external modules.  These will be collected
and applied to the real module(s) being processed.
       
Deviations are applied as patches to the target module.
Since they are not identified in the target module at
all (ala imports), they have to be specified
explicitly, so they will be correctly processed.
Zero or more instances of this parameter are allowed.
.IP --\fBdisplay-mode\fP=enum
Controls how values are displayed during output
to STDOUT or a log file.
.nf
    enum values:
       plain(0)
          Plain identifier without any prefix format.
       prefix(1)
          Plain text with XML prefix added format.
       module(2)
          Plain text with module name as prefix added format.
       xml(3)
          XML format.
.fi
.IP --\fBfixorder\fP=boolean
Controls whether PDU parameters will be
automatically sent to the server in the
correct order.  
If true, then canonical order will be used.
This is the default value.
If false, the specified order will be used. 
.IP --\fBhelp\fP
Print this help text and exit.
The help-mode choice (--brief, --normal, or --full) may also be present
to control the amount of help text printed.
.IP --\fBindent\fP=number
Number of spaces to indent (0..9) in formatted output.
The default is 3 spaces.
.IP --\fBlog\fP=filespec
Filespec for the log file to use instead of STDOUT.
If this string begins with a '~' character,
then a username is expected to follow or
a directory separator character.  If it begins
with a '$' character, then an environment variable
name is expected to follow.
.IP --\fBlog-append\fP
If present, the log will be appended not over-written.
If not, the log will be over-written.
Only meaningful if the \fBlog\fP parameter is
also present.
.IP --\fBlog-level\fP=enum
Sets the debug logging level for the program.
.IP --\fBmodpath\fP=list
Directory search path for YANG and YIN files.
Overrides the YUMA_MODPATH environment variable.
.IP --\fBmodule\fP=string
YANG or YIN source module name to load upon startup.
If this string represents a filespec, 
ending with the \fB.yang\fP or \fB.yin\fP extension,
then only that file location will be checked.

If this string represents a module name, then
the module search path will be checked for
a file the \fB.yang\fP or \fB.yin\fP extension.

If this string begins with a '~' character,
then a username is expected to follow or
a directory separator character.  If it begins
with a '$' character, then an environment variable
name is expected to follow.
.nf

      ~/some/path ==> <my-home-dir>/some/path

      ~fred/some/path ==> <fred-home-dir>/some/path

      $workdir/some/path ==> <workdir-env-var>/some/path
.fi
.IP --\fBpassword\fP=string
User password to use for NETCONF sessions.
If none, then user will be prompted before connecting.
.IP --\fBport\fP=number
The NETCONF port number to use for starting sessions.
If not present, then port 830, followed by port 22, will be tried.
.IP --\fBrunpath\fP=list
Internal file search path for script files.
Overrides the YUMA_RUNPATH environment variable.
.IP --\fBserver\fP=string
IP address or DNS name of the NETCONF server target to
use for the auto-startup mode, or as the default value
when starting a new session.
.IP --\fBsubdirs\fP=boolean
If false, the file search paths for modules, scripts, and data
files will not include sub-directories if they exist in the
specified path.
      
If true, then these file search paths will include
sub-directories, if present.  Any directory name beginning
with a dot (\fB.\fP) character, or named \fBCVS\fP, will be ignored.
This is the default mode.
.IP --\fBtimeout\fP=number
The number of seconds to wait for a response
from the server before declaring a timeout.
Zero means do not timeout at all.
.IP --\fBuser\fP=string
User name to use for NETCONF sessions.
This value will be used in auto-startup mode,
or as the default value when starting a new
session.
.IP --\fBversion\fP
Print the program version string and exit.
.IP --\fBwarn-idlen\fP=number
 Control whether identifier length warnings will be
generated.  The value zero disables all identifier
length checking.  If non-zero, then a warning will
be generated if an identifier is defined which 
has a length is greater than this amount.
range: 0 | 8 .. 1023.
The default value is 64.
.IP --\fBwarn-linelen\fP=number
Control whether line length warnings will be
generated.  The value zero disables all line length
checking.  If non-zero, then a warning will
be generated if the line length is greater than
this amount.  Tab characters are counted as 8 spaces.
range: 0 | 40 .. 4095.
The default value is 72.
.IP --\fBwarn-off\fP=number
Control whether the specified warning number will be
generated and counted in the warning total for the
module being parsed.
range: 400 .. 899.
This parameter may be entered zero or more times.
.IP --\fByuma-home\fP=string
Directory for the yuma project root to use.
If present, this directory location will
override the YUMA_HOME environment variable,
if it is present.  If a zero-length string is
entered, then the YUMA_HOME environment variable
will be ignored.

.SH SEARCH PATH
When a module name is entered as input, or when a
module or submodule name is specified in an import or include
statement within the file, the following search algorithm
is used to find the file:
.nf    

  1) file is in the current directory
  2) YUMA_MODPATH environment var (or set by modpath parameter)
  3) $HOME/modules directory
  4) $YUMA_HOME/modules directory
  5) $YUMA_INSTALL/modules directory OR
     default install module location, '/usr/share/yuma/modules'

.fi
By default, the entire directory tree for all locations
(except step 1) will be searched, not just the specified
directory.  The \fBsubdirs\fP parameter can be used to
prevent sub-directories from being searched.
    
Any directory name beginning with a dot character (\fB.\fP)
will be skipped.  Also, any directory named \fBCVS\fP will
be skipped in directory searches.

.SH ERROR LOGGING
By default, warnings and errors are sent to STDOUT.
    
A log file can be specified instead with the \fBlog\fP' parameter.

Existing log files can be reused with the 'logappend'
parameter, otherwise log files are overwritten.
    
The logging level can be controlled with the \fBlog-level\fP
parameter.

The default log level is 'info'.  The
log-levels are additive:
.nf

     off:    suppress all errors (not recommended!)
             A program return code of '1' indicates some error.
     error:  print errors
     warn:   print warnings
     info:   print generally interesting trace info
     debug:  print general debugging trace info
     debug2: print verbose debugging trace info
     debug3: print very verbose debugging trace info

.fi

.SH ENVIRONMENT
The following optional environment variables can be used
to control module search behavior:
.IP \fBHOME\fP
The user's home directory  (e.g., /home/andy)
.IP \fBYUMA_HOME\fP
The root of the user's Yuma work directory
(e.g., /home/andy/swdev/netconf)
.IP \fBYUMA_INSTALL\fP
The root of the directory that yangdump
is installed on this system (default is, /usr/share/yang)
.IP \fBYUMA_DATAPATH\fP
Colon-separated list of directories to
search for data files.
(e.g.: './workdir/data-files:/home/andy/test-data')
The \fBdatapath\fP parameter will override this
environment variable, if both are present.
.IP \fBYUMA_MODPATH\fP
Colon-separated list of directories to
search for modules and submodules.
(e.g.: './workdir/modules:/home/andy/test-modules')
The \fBmodpath\fP parameter will override this
environment variable, if both are present.
.IP \fBYUMA_RUNPATH\fP
Colon-separated list of directories to
search for script files.
(e.g.: './workdir/scripts:/home/andy/scripts')
The \fBrunpath\fP parameter will override this
environment variable, if both are present.
.SH CONFIGURATION FILES
.IP \fByangcli.conf\fP
YANG config file
The default is: \fB/etc/yuma/yangcli.conf\fP
    
An ASCII configuration file format is supported to
store command line parameters. 

The \fBconfig\fP parameter
is used to specify a specific config file, otherwise
the default config file will be checked.
.nf    

   - A hash mark until EOLN is treated as a comment
   - All text is case-sensitive
   - Whitespace within a line is not significant
   - Whitespace to end a line is significant/
     Unless the line starts a multi-line string,
     an escaped EOLN (backslash EOLN) is needed
     to enter a leaf on multiple lines.
   - For parameters that define lists, the key components
     are listed just after the parameter name, without
     any name,  e.g.,
    
            interface eth0 {
              # name = eth0 is not listed inside the braces
              ifMtu 1500
              ifName mySystem
            }

.fi    
A config file can contain any number of parameter
sets for different programs. 

Each program must have its own section, identifies by its name:
.nf    

     # this is a comment
     yangcli {
        log-level debug
        default-module yuma-interfaces
     }
    
.fi

.SH FILES
The following data files must be present in the module
search path in order for this program to function:
    
  * \fBYANG module library\fP
    default: /usr/share/yang/modules/
    

.SH DIAGNOSTICS
Internal diagnostics may generate the following
type of message if any bugs are detected at runtime:
  
    [E0]
         filename.c:linenum error-number (error-msg)
    
.SH AUTHOR
Andy Bierman, <andy at netconfcentral dot org>

.SH SEE ALSO
.BR netconf-subsystem (1)
.BR netconfd (1)
.BR yangdiff (1)
.BR yangdump (1)
